<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur Plan Pennylane - Partenaires Prescripteurs</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel pour transpiler JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts - Manrope -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Manrope', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes zoomIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-in {
            animation: fadeIn 0.5s ease-out;
        }
        .slide-in-from-top {
            animation: slideIn 0.5s ease-out;
        }
        .zoom-in {
            animation: zoomIn 0.7s ease-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // UI Components
        const Card = ({ children, className = "", style = {} }) => (
            <div className={`rounded-lg border bg-white shadow-sm ${className}`} style={style}>{children}</div>
        );
        const CardHeader = ({ children }) => <div className="p-6 pb-4">{children}</div>;
        const CardTitle = ({ children, className = "" }) => <h3 className={`text-2xl font-bold ${className}`}>{children}</h3>;
        const CardContent = ({ children, className = "" }) => <div className={`p-6 pt-0 ${className}`}>{children}</div>;
        
        const Button = ({ children, onClick, disabled = false, size = "default", className = "", style = {} }) => {
            const sizes = { default: "px-4 py-2 text-base", lg: "px-6 py-3 text-lg" };
            return (
                <button onClick={onClick} disabled={disabled} className={`${sizes[size]} rounded-lg font-semibold transition-all duration-300 ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer hover:opacity-90'} ${className}`} style={style}>
                    {children}
                </button>
            );
        };
        
        const Badge = ({ children, className = "" }) => <span className={`inline-block rounded-full ${className}`}>{children}</span>;

        // Icons
        const CheckCircle2 = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                <polyline points="22 4 12 14.01 9 11.01" />
            </svg>
        );
        const ArrowRight = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="5" y1="12" x2="19" y2="12" />
                <polyline points="12 5 19 12 12 19" />
            </svg>
        );
        const ArrowLeft = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="19" y1="12" x2="5" y2="12" />
                <polyline points="12 19 5 12 12 5" />
            </svg>
        );
        const Sparkles = ({ className, style }) => (
            <svg className={className} style={style} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3v18M3 12h18M6.6 6.6l10.8 10.8M6.6 17.4L17.4 6.6" />
            </svg>
        );
        const Building2 = ({ className, style }) => (
            <svg className={className} style={style} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="2" y="7" width="20" height="14" rx="2" />
                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
            </svg>
        );
        const TrendingUp = ({ className, style }) => (
            <svg className={className} style={style} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                <polyline points="17 6 23 6 23 12" />
            </svg>
        );
        const InfoIcon = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="#00F872" strokeWidth="2" fill="none"/>
                <path d="M12 8V12M12 16H12.01" stroke="#00F872" strokeWidth="2" strokeLinecap="round"/>
            </svg>
        );

        const SimulateurPlanPennylane = () => {
          const [state, setState] = useState({
            step: 0,
            answers: {
              comptaDansPL: "", nbComptables: 0, fonctionnalitesPME: [],
              usersGestion: 0, usersEmployes: 0, facturesAnnuelles: 0,
              fonctionnalitesEssentiel: [], fonctionnalitesPremium: [],
            },
            result: null,
          });

          const [showEmailPage, setShowEmailPage] = useState(false);
          const [emailCopied, setEmailCopied] = useState(false);
          const maxSteps = 8;

          const calculateResult = (answers) => {
            const totalUsers = answers.usersGestion + answers.usersEmployes;
            
            if (totalUsers > 10 || answers.usersGestion > 5 || answers.nbComptables > 1 || answers.facturesAnnuelles > 3600 || (answers.fonctionnalitesPME.length > 0 && !answers.fonctionnalitesPME.includes("aucune"))) {
              return {
                plan: "PME sur mesure", palier: 0, prix: 0,
                usersIncluded: "Utilisateurs illimit√©s", facturesMax: "Factures illimit√©es",
                justification: ["Votre client d√©passe les limites des plans standards"],
                fonctionnalites: ["Toutes les fonctionnalit√©s Premium + CI", "Fonction groupe et gestion multi-entit√©s", "EBICS T et paiements avanc√©s", "API PME compl√®te", "Circuits de validation multiniveaux", "Demandes d'achat et de paiement", "Account Manager d√©di√©"],
              };
            }

            let palier = 1;
            if (answers.usersGestion === 2 || (answers.usersEmployes >= 1 && answers.usersEmployes <= 3)) palier = Math.max(palier, 2);
            if (answers.usersGestion >= 3 || answers.usersEmployes >= 4) palier = Math.max(palier, 3);
            if (answers.facturesAnnuelles >= 1200 && answers.facturesAnnuelles < 2400) palier = Math.max(palier, 2);
            if (answers.facturesAnnuelles >= 2400) palier = Math.max(palier, 3);

            const usersIncluded = [];
            if (palier === 1) usersIncluded.push("1 utilisateur Gestion");
            else if (palier === 2) usersIncluded.push("Jusqu'√† 2 utilisateurs Gestion");
            else usersIncluded.push("Jusqu'√† 5 utilisateurs Gestion");
            if (palier === 2) usersIncluded.push("Jusqu'√† 3 utilisateurs Employ√©s");
            else if (palier === 3) usersIncluded.push("Jusqu'√† 5 utilisateurs Employ√©s");
            if (answers.nbComptables > 0) usersIncluded.push("1 utilisateur Comptable interne");

            const facturesMax = palier === 1 ? "1 200 factures/an" : palier === 2 ? "2 400 factures/an" : "3 600 factures/an";

            let plan = "", fonctionnalites = [];
            if (answers.comptaDansPL === "oui") {
              plan = "Premium + Module Comptable";
              fonctionnalites = ["Toutes les fonctionnalit√©s Premium", "Saisie comptable compl√®te", "D√©clarations TVA et liasse fiscale", "Module de r√©vision et cut-off", "√âtats financiers personnalisables"];
            } else {
              const hasPremium = answers.fonctionnalitesPremium.length > 0 && !answers.fonctionnalitesPremium.includes("aucune");
              const hasEssentiel = answers.fonctionnalitesEssentiel.length > 0 && !answers.fonctionnalitesEssentiel.includes("aucune");
              if (hasPremium) {
                plan = "Premium";
                fonctionnalites = ["Circuits de validation", "Rapports analytiques avanc√©s", "Data Sharing", "Tableaux de bords personnalisables"];
              } else if (hasEssentiel) {
                plan = "Essentiel";
                fonctionnalites = ["Relances automatiques", "Factures r√©currentes", "Int√©grations cl√©-en-main", "Notes de frais", "Analytique et pr√©visionnel"];
              } else {
                plan = "Basique";
                fonctionnalites = ["Facturation clients illimit√©e", "Gestion des d√©penses", "Paiement fournisseurs", "Compte Pro avec cartes"];
              }
            }

            const prixTable = {"Basique": [14, 29, 49], "Essentiel": [24, 49, 99], "Premium": [49, 79, 199], "Premium + Module Comptable": [79, 149, 298]};
            return {plan, palier, prix: prixTable[plan]?.[palier - 1] || 0, usersIncluded: usersIncluded.join(", "), facturesMax, justification: [], fonctionnalites};
          };

          const goNext = () => {
            if (state.step === 0) { setState({ ...state, step: state.answers.comptaDansPL === "oui" ? 1 : 2 }); return; }
            if (state.step === 1) { if (state.answers.nbComptables > 1) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } setState({ ...state, step: 2 }); return; }
            if (state.step === 2) { if (state.answers.fonctionnalitesPME.length > 0 && !state.answers.fonctionnalitesPME.includes("aucune")) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } setState({ ...state, step: 3 }); return; }
            if (state.step === 3) { if (state.answers.usersGestion > 5) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } setState({ ...state, step: 4 }); return; }
            if (state.step === 4) { if (state.answers.usersEmployes > 5) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } setState({ ...state, step: 5 }); return; }
            if (state.step === 5) { if (state.answers.facturesAnnuelles > 3600) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } if (state.answers.comptaDansPL === "oui") { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; } setState({ ...state, step: 6 }); return; }
            if (state.step === 6) { setState({ ...state, step: 7 }); return; }
            if (state.step === 7) { setState({ ...state, result: calculateResult(state.answers), step: maxSteps }); return; }
          };

          const goBack = () => {
            if (state.step === maxSteps) { setState({ step: 0, result: null, answers: {comptaDansPL: "", nbComptables: 0, fonctionnalitesPME: [], usersGestion: 0, usersEmployes: 0, facturesAnnuelles: 0, fonctionnalitesEssentiel: [], fonctionnalitesPremium: []}}); setShowEmailPage(false); return; }
            if (state.step === 2) { setState({ ...state, step: state.answers.comptaDansPL === "oui" ? 1 : 0 }); return; }
            if (state.step === 1) { setState({ ...state, step: 0 }); return; }
            setState({ ...state, step: Math.max(0, state.step - 1) });
          };

          const canProceed = () => {
            switch (state.step) {
              case 0: return state.answers.comptaDansPL !== "";
              case 1: return state.answers.nbComptables > 0;
              case 2: return state.answers.fonctionnalitesPME.length > 0;
              case 3: return state.answers.usersGestion > 0;
              case 4: return true;
              case 5: return state.answers.facturesAnnuelles > 0;
              case 6: return state.answers.fonctionnalitesEssentiel.length > 0;
              case 7: return state.answers.fonctionnalitesPremium.length > 0;
              default: return false;
            }
          };

          const getProgressPercentage = () => {
            if (state.step >= maxSteps) return 100;
            const totalQuestions = state.answers.comptaDansPL === "oui" ? (state.answers.nbComptables === 1 ? 6 : 2) : 7;
            return Math.round((state.step / totalQuestions) * 100);
          };

          const renderQuestion = () => {
            if (state.step === 0) return (
              <div className="space-y-8">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>Module comptable</h2>
                  <p className="text-xl" style={{color:'#006666'}}>La comptabilit√© est-elle g√©r√©e en interne ou externalis√©e aupr√®s de votre expert comptable ?</p>
                </div>
                <div className="space-y-3">
                  {[{value:"oui",label:"Internalis√©e, ou au moins une partie (Expert Comptable en r√©vision)"},{value:"non",label:"Externalis√©e, notre comptabilit√© est g√©r√©e par notre Expert Comptable"}].map(o=>
                    <label key={o.value} className="flex items-start gap-3 p-4 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors">
                      <input type="radio" checked={state.answers.comptaDansPL===o.value} onChange={()=>setState({...state,answers:{...state.answers,comptaDansPL:o.value}})} className="mt-1"/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 1) return (
              <div className="space-y-6">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>De combien d'Utilisateurs Comptable<span style={{color:'#00F872'}}>*</span> avez-vous besoin ?</h2>
                  <div className="rounded-xl p-6 border-2" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                    <p className="font-bold flex items-center gap-3 text-xl mb-3" style={{color:'#003D3D'}}>
                      <InfoIcon/>Utilisateur Comptable
                    </p>
                    <p className="text-base mb-3" style={{color:'#006666'}}>Utilisateur ayant acc√®s au module comptable. Il peut effectuer la saisie comptable, les d√©clarations fiscales, la r√©vision et les cl√¥tures.</p>
                    <p className="text-base font-semibold" style={{color:'#006666'}}>Exemples : Comptable fournisseurs, Comptable clients, Directeur Comptable, Responsable comptable</p>
                  </div>
                </div>
                <div className="space-y-3">
                  {[{value:1,label:"1"},{value:2,label:"2 ou plus"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-teal-400 hover:bg-teal-50/50 transition-all">
                      <input type="radio" checked={state.answers.nbComptables===o.value} onChange={()=>setState({...state,answers:{...state.answers,nbComptables:o.value}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 2) return (
              <div className="space-y-8">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>Fonctionnalit√©s avanc√©es PME</h2>
                  <p className="text-xl" style={{color:'#006666'}}>Votre client a-t-il besoin d'au moins une de ces fonctionnalit√©s avanc√©es ?</p>
                  <p className="text-base font-bold" style={{color:'#00F872'}}>(Disponible uniquement avec l'offre PME sur mesure)</p>
                  <div className="rounded-xl p-5 border-2 bg-white" style={{borderColor:'#96EAD3'}}>
                    <ul className="space-y-3 text-base">
                      {["Circuits de validation complexes (3+ niveaux)","Demandes de paiement avec workflow","Demandes d'achat avec workflow","Plan analytique structur√© multi-axes","Paiements EBICS T","Gestion multi-entit√©s / Fonction groupe","API PME avanc√©e"].map((f,i)=>
                        <li key={i} className="flex items-start gap-3">
                          <span className="font-black text-xl" style={{color:'#00F872'}}>‚Ä¢</span>
                          <span style={{color:'#003D3D'}}><strong>{f}</strong></span>
                        </li>
                      )}
                    </ul>
                  </div>
                </div>
                <div className="space-y-3 p-5 rounded-xl" style={{backgroundColor:'#F0FDF4'}}>
                  {[{value:"oui",label:"Oui, besoin d'au moins une de ces fonctionnalit√©s"},{value:"non",label:"Non, aucune de ces fonctionnalit√©s n'est n√©cessaire"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 bg-white cursor-pointer" style={{borderColor:'#96EAD3'}}>
                      <input type="radio" checked={state.answers.fonctionnalitesPME.includes(o.value==="oui"?"needsPME":"aucune")} onChange={()=>setState({...state,answers:{...state.answers,fonctionnalitesPME:o.value==="oui"?["needsPME"]:["aucune"]}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 3) return (
              <div className="space-y-6">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>De combien d'Utilisateurs Gestion<span style={{color:'#00F872'}}>*</span> avez-vous besoin ?</h2>
                  <div className="rounded-xl p-6 border-2" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                    <p className="font-bold flex items-center gap-3 text-xl mb-3" style={{color:'#003D3D'}}>
                      <InfoIcon/>Utilisateur Gestion
                    </p>
                    <p className="text-base mb-3" style={{color:'#006666'}}>Utilisateur ayant acc√®s √† la facturation clients, aux achats fournisseurs, √† la tr√©sorerie et aux op√©rations bancaires.</p>
                    <p className="text-base font-semibold" style={{color:'#006666'}}>Exemples : Dirigeant, DAF, Responsable administratif, Gestionnaire de facturation</p>
                  </div>
                </div>
                <div className="space-y-3">
                  {[{value:1,label:"1 personne"},{value:2,label:"2 personnes"},{value:3,label:"3 √† 5 personnes"},{value:6,label:"6 personnes ou plus"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-teal-400 hover:bg-teal-50/50 transition-all">
                      <input type="radio" checked={state.answers.usersGestion===o.value} onChange={()=>setState({...state,answers:{...state.answers,usersGestion:o.value}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 4) return (
              <div className="space-y-6">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>De combien d'Utilisateurs Employ√©<span style={{color:'#00F872'}}>*</span> avez-vous besoin ?</h2>
                  <div className="rounded-xl p-6 border-2" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                    <p className="font-bold flex items-center gap-3 text-xl mb-3" style={{color:'#003D3D'}}>
                      <InfoIcon/>Utilisateur Employ√©
                    </p>
                    <p className="text-base mb-3" style={{color:'#006666'}}>Utilisateur ayant acc√®s uniquement aux notes de frais, carte bancaire Pennylane et demandes d'achat.</p>
                    <p className="text-base mb-3" style={{color:'#006666'}}>En revanche, il n'a aucun acc√®s au reste du module de gestion (facturation, tr√©sorerie...) et √† la comptabilit√©.</p>
                    <p className="text-base font-semibold" style={{color:'#006666'}}>Exemples : Commerciaux, Responsables Marketing, Chefs de projet et autres m√©tiers non li√©s √† la comptabilit√©/gestion</p>
                    <div className="mt-4 rounded-lg p-4 border-2" style={{backgroundColor:'#FEF3C7',borderColor:'#F59E0B'}}>
                      <p className="font-bold text-base flex items-start gap-2" style={{color:'#92400E'}}>
                        <span className="text-xl">‚ö†Ô∏è</span>
                        <span>Un utilisateur Gestion qui a √©galement besoin de faire ses notes de frais n'est pas consid√©r√© comme un utilisateur Employ√© mais comme un utilisateur Gestion uniquement.</span>
                      </p>
                    </div>
                  </div>
                </div>
                <div className="space-y-3">
                  {[{value:0,label:"Aucun"},{value:1,label:"1 √† 3 employ√©s"},{value:4,label:"4 √† 5 employ√©s"},{value:6,label:"6 employ√©s ou plus"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-teal-400 hover:bg-teal-50/50 transition-all">
                      <input type="radio" checked={state.answers.usersEmployes===o.value} onChange={()=>setState({...state,answers:{...state.answers,usersEmployes:o.value}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 5) return (
              <div className="space-y-6">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>Volume de factures</h2>
                  <p className="text-xl" style={{color:'#006666'}}>Quelle est la volum√©trie annuelle de factures (achats + ventes + notes de frais) ?</p>
                </div>
                <div className="space-y-3">
                  {[{value:600,label:"0 √† 1 200 factures/an (‚âà 0-100/mois)"},{value:1800,label:"1 200 √† 2 400 factures/an (‚âà 100-200/mois)"},{value:3000,label:"2 400 √† 3 600 factures/an (‚âà 200-300/mois)"},{value:4000,label:"Plus de 3 600 factures/an (‚âà 300+/mois)"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:border-teal-400 hover:bg-teal-50/50 transition-all">
                      <input type="radio" checked={state.answers.facturesAnnuelles===o.value} onChange={()=>setState({...state,answers:{...state.answers,facturesAnnuelles:o.value}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 6) return (
              <div className="space-y-8">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>Fonctionnalit√©s du Module Gestion</h2>
                  <p className="text-xl" style={{color:'#006666'}}>Votre client a-t-il besoin d'au moins une de ces fonctionnalit√©s ?</p>
                  <p className="text-base font-bold" style={{color:'#00F872'}}>(Disponible uniquement √† partir du plan Essentiel)</p>
                  <div className="rounded-xl p-5 border-2 bg-white" style={{borderColor:'#96EAD3'}}>
                    <ul className="space-y-3 text-base">
                      {["Relances automatiques des factures impay√©es","Factures r√©currentes / Abonnements clients","Int√©grations cl√©-en-main (Shopify, Sellsy, +150 outils)","Notes de frais avec indemnit√©s kilom√©triques","Analytique et pr√©visionnel de tr√©sorerie"].map((f,i)=>
                        <li key={i} className="flex items-start gap-3">
                          <span className="font-black text-xl" style={{color:'#00F872'}}>‚Ä¢</span>
                          <span style={{color:'#003D3D'}}><strong>{f}</strong></span>
                        </li>
                      )}
                    </ul>
                  </div>
                </div>
                <div className="space-y-3 p-5 rounded-xl" style={{backgroundColor:'#F0FDF4'}}>
                  {[{value:"oui",label:"Oui, besoin d'au moins une de ces fonctionnalit√©s"},{value:"non",label:"Non, ces fonctionnalit√©s ne sont pas n√©cessaires"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 bg-white cursor-pointer" style={{borderColor:'#96EAD3'}}>
                      <input type="radio" checked={state.answers.fonctionnalitesEssentiel.includes(o.value==="oui"?"needsEssentiel":"aucune")} onChange={()=>setState({...state,answers:{...state.answers,fonctionnalitesEssentiel:o.value==="oui"?["needsEssentiel"]:["aucune"]}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            if (state.step === 7) return (
              <div className="space-y-8">
                <div className="space-y-4">
                  <h2 className="text-4xl font-bold" style={{color:'#003D3D'}}>Fonctionnalit√©s du Module Gestion</h2>
                  <p className="text-xl" style={{color:'#006666'}}>Votre client a-t-il besoin d'au moins une de ces fonctionnalit√©s ?</p>
                  <p className="text-base font-bold" style={{color:'#00F872'}}>(Disponible uniquement √† partir du plan Premium)</p>
                  <div className="rounded-xl p-5 border-2 bg-white" style={{borderColor:'#96EAD3'}}>
                    <ul className="space-y-3 text-base">
                      {["Circuits de validation des achats (workflows d'approbation)","Rapports analytiques avanc√©s (ventilation multi-axes)","Data Sharing (exports vers Power BI, Tableau, Excel)","Tableaux de bords personnalisables avec KPI","Rapports comptables (Grand Livre, Balances, P&L)"].map((f,i)=>
                        <li key={i} className="flex items-start gap-3">
                          <span className="font-black text-xl" style={{color:'#00F872'}}>‚Ä¢</span>
                          <span style={{color:'#003D3D'}}><strong>{f}</strong></span>
                        </li>
                      )}
                    </ul>
                  </div>
                </div>
                <div className="space-y-3 p-5 rounded-xl" style={{backgroundColor:'#F0FDF4'}}>
                  {[{value:"oui",label:"Oui, besoin d'au moins une de ces fonctionnalit√©s"},{value:"non",label:"Non, ces fonctionnalit√©s ne sont pas n√©cessaires"}].map(o=>
                    <label key={o.value} className="flex items-center gap-3 p-4 rounded-xl border-2 bg-white cursor-pointer" style={{borderColor:'#96EAD3'}}>
                      <input type="radio" checked={state.answers.fonctionnalitesPremium.includes(o.value==="oui"?"needsPremium":"aucune")} onChange={()=>setState({...state,answers:{...state.answers,fonctionnalitesPremium:o.value==="oui"?["needsPremium"]:["aucune"]}})}/>
                      <span className="flex-1">{o.label}</span>
                    </label>
                  )}
                </div>
              </div>
            );

            return null;
          };

          const renderEmailPage = () => {
            if (!state.result) return null;
            const isPME = state.result.plan === "PME sur mesure";
            const emailSubject = `Demande de devis - Plan ${state.result.plan}`;
            const emailBody = isPME ? `Bonjour Jules,\n\nJe souhaite obtenir un devis personnalis√© pour l'offre PME sur mesure de Pennylane.\n\nüìã CONTEXTE DU BESOIN\nSuite √† ma simulation, mon client n√©cessite une solution sur mesure d√©passant les plans standards.\n\nüìù INFORMATIONS POUR LE DEVIS\nMerci de me recontacter pour √©changer sur ce projet.\n\nSIGNATAIRE DU DEVIS\n- Nom : [√Ä COMPL√âTER]\n- Pr√©nom : [√Ä COMPL√âTER]\n- Email : [√Ä COMPL√âTER]\n- T√©l√©phone : [√Ä COMPL√âTER]\n\nENTREPRISE\n- Nom de l'entreprise : [√Ä COMPL√âTER]\n- SIREN : [√Ä COMPL√âTER]\n- Secteur d'activit√© : [√Ä COMPL√âTER]\n- Effectif : [√Ä COMPL√âTER]\n\nüìû Disponibilit√©s pour un rendez-vous :\n- [√Ä COMPL√âTER]\n\nCordialement` : `Bonjour Jules,\n\nJe souhaite obtenir un devis pour le plan ${state.result.plan}.\n\nüìã D√âTAILS DU SIMULATEUR\n- Plan recommand√© : ${state.result.plan}\n- Prix indicatif : ${state.result.prix}‚Ç¨/mois HT\n- Utilisateurs : ${state.result.usersIncluded}\n- Factures : ${state.result.facturesMax}\n\nüìù COMPL√âTEZ VOS INFORMATIONS CI-DESSOUS\nMerci de remplir les champs suivants avant d'envoyer votre demande :\n\nSIGNATAIRE DU DEVIS\n- Nom : [√Ä COMPL√âTER]\n- Pr√©nom : [√Ä COMPL√âTER]\n- Email : [√Ä COMPL√âTER]\n\nENTREPRISE\n- Nom de l'entreprise : [√Ä COMPL√âTER]\n- SIREN : [√Ä COMPL√âTER]\n\nCordialement`;
            const copyToClipboard = () => { navigator.clipboard.writeText(emailBody).then(() => { setEmailCopied(true); setTimeout(() => setEmailCopied(false), 3000); }); };

            return (
              <div className="space-y-6">
                <div className="text-center space-y-4">
                  <div className="text-6xl mb-4">üìß</div>
                  <h2 className="text-4xl font-bold mb-2" style={{color:'#003D3D'}}>Demande de devis</h2>
                  <p className="text-xl" style={{color:'#006666'}}>Pour obtenir votre devis personnalis√© pour le plan <strong>{state.result.plan}</strong></p>
                </div>
                <Card>
                  <CardContent className="p-8 space-y-6">
                    <div>
                      <p className="text-lg mb-4 font-semibold text-center" style={{color:'#003D3D'}}>üìã Message √† copier et envoyer par email</p>
                      <div className="rounded-xl p-6 border-2 mb-4 font-mono text-sm whitespace-pre-wrap" style={{backgroundColor:'#F8FAFC',borderColor:'#96EAD3',color:'#003D3D'}}>
                        <div className="mb-4 pb-4 border-b-2" style={{borderColor:'#DAFBF2'}}>
                          <p><strong>√Ä :</strong> jules.prevosteau@pennylane.com</p>
                          <p><strong>Objet :</strong> {emailSubject}</p>
                        </div>
                        {emailBody}
                      </div>
                      <Button onClick={copyToClipboard} size="lg" className="w-full font-semibold text-lg border-2" style={{borderColor:'#00F872',color:'#003D3D',backgroundColor:emailCopied?'#DAFBF2':'white'}}>
                        {emailCopied?'‚úì Message copi√© !':'üìã Copier le message'}
                      </Button>
                    </div>
                    <div className="text-center pt-4">
                      <Button onClick={()=>{window.location.href=`mailto:jules.prevosteau@pennylane.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;}} size="lg" className="w-full font-semibold text-lg text-white" style={{backgroundColor:'#00F872',color:'#003D3D'}}>
                        üì® Envoyer un email √† jules.prevosteau@pennylane.com
                      </Button>
                    </div>
                  </CardContent>
                </Card>
                <div className="flex gap-4">
                  <Button onClick={()=>setShowEmailPage(false)} size="lg" className="flex-1 border-2 font-semibold text-lg bg-white" style={{borderColor:'#00F872',color:'#003D3D'}}>‚Üê Retour au r√©sultat</Button>
                  <Button onClick={goBack} size="lg" className="flex-1 border-2 font-semibold text-lg bg-white" style={{borderColor:'#96EAD3',color:'#006666'}}>Recommencer</Button>
                </div>
              </div>
            );
          };

          const renderResult = () => {
            if (!state.result) return null;
            const isPME = state.result.plan === "PME sur mesure";
            return (
              <div className="space-y-6">
                <div className="text-center space-y-4">
                  <CheckCircle2 className="w-20 h-20 mx-auto text-emerald-500 zoom-in"/>
                  <h2 className="text-4xl font-bold text-slate-800">Plan recommand√©</h2>
                  <Badge className="text-xl px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg">{state.result.plan}</Badge>
                </div>
                <Card>
                  <CardHeader><CardTitle className="flex items-center gap-2"><Sparkles className="w-5 h-5"/>D√©tails de l'offre</CardTitle></CardHeader>
                  <CardContent className="space-y-6">
                    {!isPME&&(<>
                      <div className="text-center py-8 rounded-2xl border-2 shadow-lg" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                        <div className="text-7xl font-black mb-3" style={{color:'#00F872'}}>{state.result.prix}‚Ç¨</div>
                        <div className="font-semibold text-lg" style={{color:'#003D3D'}}>HT / mois - Sans engagement</div>
                      </div>
                      <div className="p-6 rounded-xl border-2" style={{backgroundColor:'white',borderColor:'#DAFBF2'}}>
                        <div className="font-bold text-xl mb-4 flex items-center gap-3" style={{color:'#003D3D'}}>
                          <TrendingUp className="w-10 h-10" style={{color:'#00F872'}}/>Ce plan d'abonnement inclut :
                        </div>
                        <ul className="space-y-3">
                          {state.result.usersIncluded.split(", ").map((u,i)=>
                            <li key={i} className="flex items-start gap-3">
                              <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                              <span className="text-base" style={{color:'#006666'}}>{u}</span>
                            </li>
                          )}
                          <li className="flex items-start gap-3">
                            <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                            <span className="text-base" style={{color:'#006666'}}>Maximum {state.result.facturesMax}</span>
                          </li>
                        </ul>
                      </div>
                    </>)}
                    {isPME&&(
                      <div className="p-8 rounded-2xl border-2 shadow-lg" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                        <div className="flex items-center gap-4 mb-4">
                          <Building2 className="w-10 h-10" style={{color:'#00F872'}}/>
                          <div>
                            <div className="font-bold text-xl" style={{color:'#003D3D'}}>Tarification sur devis</div>
                            <div className="font-semibold text-lg" style={{color:'#006666'}}>Solution entreprise personnalis√©e</div>
                          </div>
                        </div>
                        <p className="text-base leading-relaxed mb-6" style={{color:'#006666'}}>
                          Votre client a des <strong>besoins qui d√©passent les plans standards</strong>.
                          <br/><br/>
                          Notre <strong>√©quipe commerciale</strong> √©tablira une <strong>offre modulaire</strong> adapt√©e √† ses <strong>sp√©cificit√©s</strong>.
                        </p>
                        <div className="pt-4 border-t-2" style={{borderColor:'#96EAD3'}}>
                          <div className="font-bold text-xl mb-4 flex items-center gap-3" style={{color:'#003D3D'}}>
                            <Sparkles className="w-10 h-10" style={{color:'#00F872'}}/>Avantages exclusifs PME
                          </div>
                          <ul className="space-y-3">
                            <li className="flex items-start gap-3">
                              <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                              <span className="text-base" style={{color:'#006666'}}><strong>Utilisateurs gestion et employ√©s illimit√©s</strong></span>
                            </li>
                            <li className="flex items-start gap-3">
                              <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                              <span className="text-base" style={{color:'#006666'}}><strong>Modules √† la carte</strong> selon vos besoins</span>
                            </li>
                            <li className="flex items-start gap-3">
                              <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                              <span className="text-base" style={{color:'#006666'}}><strong>Account Manager d√©di√©</strong> et accompagnement personnalis√©</span>
                            </li>
                          </ul>
                        </div>
                      </div>
                    )}
                    {!isPME&&state.result.fonctionnalites.length>0&&(
                      <div className="p-6 rounded-xl border-2" style={{backgroundColor:'#DAFBF2',borderColor:'#96EAD3'}}>
                        <div className="font-bold text-xl mb-4 flex items-center gap-3" style={{color:'#003D3D'}}>
                          <Sparkles className="w-10 h-10" style={{color:'#00F872'}}/>Fonctionnalit√©s principales
                        </div>
                        <ul className="space-y-3">
                          {state.result.fonctionnalites.map((f,i)=>
                            <li key={i} className="flex items-start gap-3">
                              <span className="font-bold text-xl" style={{color:'#00F872'}}>‚úì</span>
                              <span className="text-base" style={{color:'#006666'}}>{f}</span>
                            </li>
                          )}
                        </ul>
                      </div>
                    )}
                  </CardContent>
                </Card>
                <div className="flex gap-4">
                  <Button onClick={goBack} size="lg" className="flex-1 border-2 font-semibold text-lg bg-white" style={{borderColor:'#00F872',color:'#003D3D'}}>Recommencer</Button>
                  <Button onClick={()=>setShowEmailPage(true)} size="lg" className="flex-1 font-semibold text-lg text-white" style={{backgroundColor:'#00F872',color:'#003D3D'}}>Obtenir un devis</Button>
                </div>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-teal-50 via-cyan-50 to-emerald-50 p-4 md:p-8">
              <div className="max-w-4xl mx-auto">
                <div className="text-center mb-10 animate-in">
                  <div className="inline-block mb-6">
                    <div className="flex items-center gap-3 px-6 py-3 bg-white rounded-xl shadow-md">
                      <svg width="36" height="36" viewBox="0 0 100 100" fill="none">
                        <circle cx="40" cy="50" r="25" fill="#00F872"/>
                        <circle cx="60" cy="50" r="25" fill="#006666"/>
                      </svg>
                      <span className="font-bold text-2xl" style={{color:'#006666'}}>pennylane</span>
                    </div>
                  </div>
                  <h1 className="text-5xl font-bold mb-4" style={{color:'#003D3D'}}>Quel plan d'abonnement choisir ?</h1>
                  <p className="text-lg max-w-3xl mx-auto leading-relaxed" style={{color:'#006666'}}>Gr√¢ce √† ce simulateur, trouvez en quelques questions le plan d'abonnement adapt√© aux besoins de votre client</p>
                </div>
                {state.step<maxSteps&&(
                  <div className="mb-10 slide-in-from-top">
                    <div className="flex justify-between text-base font-semibold mb-4" style={{color:'#006666'}}>
                      <span className="flex items-center gap-3">
                        <span className="w-8 h-8 rounded-full text-white flex items-center justify-center text-sm font-bold" style={{backgroundColor:'#00F872'}}>{Math.min(state.step+1,7)}</span>
                        Question {Math.min(state.step+1,7)} / 7
                      </span>
                      <span className="font-bold" style={{color:'#00F872'}}>{getProgressPercentage()}%</span>
                    </div>
                    <div className="h-3 bg-gray-200 rounded-full overflow-hidden">
                      <div className="h-full transition-all duration-500 rounded-full" style={{width:`${getProgressPercentage()}%`,backgroundColor:'#00F872'}}/>
                    </div>
                  </div>
                )}
                <Card className="shadow-2xl border-2 animate-in zoom-in" style={{borderColor:'#DAFBF2'}}>
                  <CardContent className="p-10 md:p-12">
                    {state.step<maxSteps?renderQuestion():(showEmailPage?renderEmailPage():renderResult())}
                    {state.step<maxSteps&&(
                      <div className="flex gap-3 mt-8">
                        {state.step>0&&(
                          <Button onClick={goBack} size="lg" className="border-2 border-teal-300 text-teal-700 hover:bg-teal-50 flex items-center justify-center">
                            <ArrowLeft className="w-4 h-4 mr-2"/>Retour
                          </Button>
                        )}
                        <Button onClick={goNext} disabled={!canProceed()} size="lg" className="flex-1 bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg flex items-center justify-center">
                          Suivant<ArrowRight className="w-4 h-4 ml-2"/>
                        </Button>
                      </div>
                    )}
                  </CardContent>
                </Card>
                <div className="text-center mt-8 text-sm text-slate-500">
                  <p className="font-medium">Simulateur Partenaires Prescripteurs - Quel plan d'abonnement choisir ?</p>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SimulateurPlanPennylane />);
    </script>
</body>
</html>